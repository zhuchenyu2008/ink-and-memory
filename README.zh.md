# Ink & Memory · [English](README.md) | 中文

<p align="center">
  <img src="assets/banner.png" alt="Ink & Memory 横幅" width="700"/>
</p>

**Ink & Memory** 是一款受电子游戏《极乐迪斯科》启发而创作的日记工作室。在这里，你可以写作、反思，并通过一系列独特的内心声音，听到自己思想的回响。当你打字时，一个由不同原型组成的“内在委员会”会加入对话，提供观点、引导，甚至一丝荒诞的幽默。

这不仅仅是一个笔记本。它是一个日常写作伴侣，能够保存你的作品、整理你的思绪，并帮助你发现自己思维中的模式。它支持中英双语，并能根据你的输入语言自动切换。

---

## 核心功能

### 写作体验
Ink & Memory 的核心是一个简洁、极简的写作环境。编辑器旨在提供一个无干扰的空间，让你专注于自己的思想。在你写作时，系统会自动保存你的工作，所以你永远不用担心丢失任何一个字。

### 内在委员会
在你写作时，一个由 16 个内心声音组成的委员会将对你的文本进行评论，突出关键短语，并提供它们独特的视角。这些声音的灵感来自多种原型，从善于分析的“拆解者”到温柔的“接纳者”。此功能由一个能实时分析你写作的复杂人工智能系统驱动。

<p align="center">
  <img src="assets/writing-area.png" alt="Ink & Memory 用户界面" width="700"/>
</p>

### 时间线与日历
每一次写作都会被自动保存，并组织成时间线和日历。这使你可以轻松回顾过去的内容，查看自己的进展，并重新发现旧日的想法。

### 每日图片生成
每一天，系统都会根据你的写作内容自动生成一张独特的图片。这为你一段时间以来的思绪和情感，创造了一个美丽而富有表现力的视觉记录。

### 自定义卡组
16 个声音被组织成三个“卡组”：**内省卡组**、**学者卡组**和**哲学卡组**。你可以启用或禁用这些卡组，以自定义哪些声音处于活跃状态。你甚至可以创建包含自己声音的专属卡组。

### 好友时间线
你可以添加好友，并在自己的时间线旁边查看他们的时间线。此功能旨在培养一种连接感和共享体验，让你能看到朋友们在写些什么、想些什么。

---

## 默认声音卡组

Ink & Memory 预装了三个精心设计的卡组，包含 16 个声音，帮助你快速开始。这些声音旨在从不同角度审视你的写作——但这仅仅是个开始。

**你不必局限于这些声音。** 卡组系统允许你：
- 🔀 **复刻** 任何卡组，创建自己的定制版本
- ✏️ **编辑** 声音的个性、提示词、图标和颜色
- ➕ **创建** 全新的声音
- 🌐 **探索** 社区商店中其他用户创建的卡组
- 📤 **发布** 自己的卡组与社区分享

### 内省卡组（默认）
该卡组专注于自我反思和个人成长。

| 图标 | 名称 | 描述 |
|---|---|---|
| 🧠 | **拆解者** | 一位分析师，能将复杂情况拆解成清晰易懂的结构。 |
| ❤️ | **接纳者** | 一位温柔的支持型伴侣，能够认可用户的情绪。 |
| 👁️ | **照镜者** | 一位观察者，能指出用户行为和思想中反复出现的模式。 |
| 👊 | **启动者** | 一位激励者，能将任务分解成小步骤，并推动用户采取行动。 |
| 🧭 | **连接者** | 一位观察者，能在用户的写作中发现隐藏的主题和联系。 |
| 🎭 | **幽默者** | 一个用黑色幽默指出用户处境荒谬之处的声音。 |

### 学者卡组
该卡组为你的写作提供学术和智识层面的视角。

| 图标 | 名称 | 描述 |
|---|---|---|
| 🧭 | **语言学家** | 从语言结构、语义和语用学的角度分析你的写作。 |
| 👁️ | **画家** | 专注于美学、视觉意象和情绪。 |
| 💡 | **物理学家** | 将物理定律、力学和能量应用于你的写作。 |
| 🧠 | **计算机科学家** | 使用算法、数据结构和复杂度来分析你的思想。 |
| ❤️ | **医生** | 提供医学、生理学和心理健康方面的视角。 |
| 🧭 | **历史学家** | 提供历史背景、文化背景，并识别模式。 |

### 哲学卡组
该卡组通过不同哲学流派的视角来审视你的写作。

| 图标 | 名称 | 描述 |
|---|---|---|
| 🛡️ | **斯多葛派** | 强调理性、自我控制和接受不可控之事。 |
| 💨 | **道家** | 专注于无为、顺其自然和简约。 |
| 🤔 | **存在主义者** | 强调选择、自由、责任和创造意义。 |
| 👊 | **实用主义者** | 关注实际效果、实用性和现实世界的结果。 |

---

### 创建你的专属声音

每个声音由以下要素构成：
- **系统提示词**：塑造它的个性和视角
- **图标**：用于视觉识别
- **颜色**：为文本高亮上色

复刻一个卡组后，你可以完全掌控这些元素。想要一个更贴近你喜欢的哲学家的声音？一个专注叙事结构的评论者？一个为创意项目加油的伙伴？自己动手构建，或在社区商店直接找到。

---

## 声音如何工作

在你写作时，Ink & Memory 使用**基于轨迹的能量系统**来分析文本。背后发生的事情是：

1. **能量累积** —— 输入越多，系统获得的“能量”越高。
2. **阈值触发** —— 能量达到阈值时，AI 会分析你刚写下的内容。
3. **声音响应** —— 已启用的声音根据各自的个性寻找共鸣片段。
4. **评论出现** —— 相关的声音会高亮短语，并在侧边给出观点。

这让评论像自然冒出来一样，而不是频繁打断你的写作。

---

## 技术架构

Ink & Memory 基于为实时 AI 交互设计的现代栈：

### 前端
- **React 19 + TypeScript** —— 类型安全的组件式界面。
- **Vite** —— 迅速的开发与构建体验。
- **TipTap** —— 可扩展的富文本编辑，并有自定义扩展用于声音高亮。
- **自研 EditorEngine** —— 管理编辑状态、评论和聊天部件。

### 后端
- **FastAPI + Python** —— 高性能异步 API 服务。
- **PolyCLI** —— 以结构化提示协调 LLM 调用与重试。
- **Stateless Analyzer** —— 核心的声音分析引擎，无需服务器会话状态。
- **SQLite + WAL** —— 稳定存储，支持并发读取。

### AI 集成
- **多模型支持** —— 兼容 GPT-4、Claude、DeepSeek、Gemini 等。
- **结构化输出** —— 使用 Pydantic 确保类型安全的模型返回。
- **每日图片生成** —— 自动为你的写作生成视觉摘要。

### 关键设计决策
- **卡组架构** —— 声音被组织为可复刻、可分享的卡组。
- **父子关系** —— 复刻的卡组可从源卡组同步更新。
- **社区商店** —— 已发布的卡组可被其他用户发现与安装。

---

## 开始使用

### 先决条件
- Python 3.11+
- Node.js 18+
- [uv](https://github.com/astral-sh/uv) (用于 Python 包管理)

### 后端
```bash
cd backend
uv venv
source .venv/bin/activate   # Windows: .venv\Scripts\activate
uv pip install -r requirements.txt

# 为你的 LLM 配置创建一个 models.json 文件
# 此处的 endpoint 和 api_key 仅为示例，请使用你自己的
cat > models.json <<'EOC'
{
  "models": {
    "gpt-4o-dou": {
      "endpoint": "https://api.example.com/v1",
      "api_key": "your-api-key",
      "model": "openai/chatgpt-4o-latest"
    }
  }
}
EOC

python server.py
```
后端将运行在 `http://localhost:8765`。

### 前端
```bash
cd frontend
npm install
npm run dev
```
前端将运行在 `http://localhost:5173`。

---

## 路线图

我们对 Ink & Memory 的未来有很多想法。以下是我们正在进行的一些工作：

*   **更多的声音和卡组:** 我们计划继续扩展声音和卡组的库，为你的写作提供更多视角。
*   **更丰富、更沉浸的体验:** 我们正在探索新的方式来可视化你的条目、你的进展以及你与朋友的联系。
*   **一个创造力的平台:** 我们希望让 Ink & Memory 成为一个你不仅可以写作，还可以与他人创作、分享和协作的地方。
*   **移动应用:** 我们正在开发 Ink & Memory 的移动版本，这样你就可以随时随地写作和反思。

---

## 贡献

Ink & Memory 是一个开源项目，我们欢迎社区的贡献。如果你有兴趣贡献，请随时 fork 仓库，进行更改，然后提交拉取请求。

以下是一些你可以贡献的方式：

*   **报告错误:** 如果你发现一个错误，请在我们的 GitHub 仓库中开启一个 issue。
*   **建议功能:** 如果你对新功能有想法，请开启一个 issue 来讨论它。
*   **编写代码:** 如果你是一名开发者，我们很乐意你帮助我们构建新功能和修复错误。
*   **创建新的声音和卡组:** 如果你对新的声音或卡组有想法，我们很乐意听到。

---

## 许可证

MIT

## 致谢

- 灵感来自 [《极乐迪斯科》](https://discoelysium.com/)
- 使用 [PolyCLI](https://github.com/shuxueshuxue/PolyCLI) 构建
- 字体: [Excalifont](https://github.com/excalidraw/excalidraw) & 小赖
